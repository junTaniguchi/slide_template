# slide_template

## 概要
`dual_style_slide_template.html` は、生成AIにコンテンツ作成を任せることを前提にしたHTML単一ファイルのスライドテンプレートです。華美な演出にも社内共有用のシンプルデザインにも対応し、必須スライドとクッションスライドを標準で備えています。

## ファイル構成
- `dual_style_slide_template.html`  
  タイトル → アジェンダ → クッション → 背景 → 目的 → クッション → サマリー → ロードマップ → ステークホルダー・ガント → 全体まとめ → 追加資料の順に並んだスライド群を収録しています。各コンテンツ差し替え箇所には `data-ai-field` 属性が付与されています。

## 使い方
1. テンプレートをブラウザで開きます。白基調のデザインで統一されており、全スライドを縦スクロールで一括確認できます。
2. 実際の資料構成に合わせて、不要なスライドは削除・順番変更・複製を行ってください。テンプレートのスライド順はあくまで推奨例であり、10枚・20枚といった任意の枚数へ柔軟に拡張できます。
3. 各スライド右上（スライド外）に表示される `SVGコピー` ボタンから、その場でSVGをクリップボードへコピーできます。PowerPointに貼り付けるとテキストも編集可能な状態で反映されます（Clipboard API非対応環境ではSVGファイルがダウンロードされます）。
4. Gemini の Gem や ChatGPT のマイGPT等にテンプレートファイルを知識として読み込ませ、以下の推奨プロンプトを使用してコンテンツ生成を依頼します。
5. 生成されたHTMLを貼り付けて差分を確認し、必要に応じてロードマップ／ステークホルダー・ガントの列数やタスク配置を調整したり補足スライド（appendix セクション）を複製して追記します。
6. 最終的なHTMLをダウンロード・配布用に出力してください。

### テンプレートで押さえているポイント
- スライド間の論理接続を保つため、アジェンダ切り替えや内容の飛躍を防ぐクッションスライドを配置。
- `chart-card`／`viz-card` には、絵文字・簡易SVG・表などで簡易チャート／ポンチ絵を実際に描き込めるスペースを確保。
- 主要カードには絵文字ベースのサンプルポンチ絵を初期配置しており、生成AIが表現形式を学習しやすくしています。
- 進捗報告・企画提案向けに、四半期×レーン単位で編集できるロードマップボードを追加。
- ロードマップと連動し、ステークホルダー別のタスク・連携先・時系列を矢羽つきガントチャート形式で俯瞰できるスライドを搭載。
- すべてのスライド右下に赤字の「CONFIDENTIAL」ラベルを表示し、秘匿資料であることを明確化。
- 各スライド右上の `SVGコピー` ボタンで、描画内容をそのままSVGとして取得（クリップボードまたはダウンロード）し、PowerPoint等へ貼り付け可能。
- 装飾用アイコンは可能な限り Unicode 16.0 / Emoji 16.0 準拠の絵文字で代用できるように設計しており、生成AIへも同方針を指示できます。
- 全スライドを縦に並べたビューのままレビューでき、上下移動に関する追加スクリプトは不要です。
- スライドセットはモジュール式で、アジェンダに応じて任意に追加・削除・順序変更しやすいレイアウトを想定しています。
- 各スライドにリード文スロットと次スライドへの橋渡し文を用意し、ストーリー展開を明示化。

### 用途別ヒント
- **調査結果の報告**: 背景スライドでファクトを整理し、ロードマップレーンを「施策」「リスク」「依存関係」などの観点に差し替えて進捗を可視化。
- **進捗報告・ステータス共有**: ロードマップの列ラベルを月／四半期／マイルストーンに変更し、セル内で完了状況や指標を整理。凡例エリアで進行中・遅延などの色分け指示を記入します。
- **企画提案**: クッションスライドで「現状→提案→効果」の流れを補強し、ロードマップには導入フェーズと成果計測フェーズを分けて描写すると検討の抜け漏れを防げます。

### ロードマップスライドの調整
- 列数を変えたい場合は `<div class="roadmap-board" style="--roadmap-columns: 4">` の数値を変更し、不要な列ブロックを削除または追加します。
- 行を増やす場合は `.roadmap-row` ブロックごと複製し、`roadmap_lane_X_*` の `data-ai-field` 名を連番で追加してください。
- AIに矢印やコネクタ、色分けの指示を出したいときは、各セルのテキスト内で「青矢印で依存関係」「赤枠で遅延リスク」と明記するとキャンバス上でも指示が残りやすくなります。
- 画像のような複雑なガント図を再現したい場合は、テンプレート内で構造を保ったままセルに「矩形を3段重ね」「矢印を折れ線で」など描画指示を書くことで、生成AIが図形配置の意図を理解しやすくなります。

### ステークホルダー・ガントの調整
- 列数を変更する場合は `<div class="stakeholder-gantt" style="--timeline-columns: 6">` の数値、および `.gantt-header` 内の列ヘッダ・`.gantt-guides` の `<span>` 数を揃えてください。
- 行を追加する際は `.gantt-row` ブロックを複製し、`stakeholder_lane_X_*` やタスク用フィールド名が重複しないよう番号を更新します。
- `gantt-task` 要素の `--start`（開始列）と `--end`（終了列）を調整してタスクの長さを指定します。`--task-color` を変えることでガントバーの色も切り替えられます。
- 各タスクには `gantt-task-title`／`gantt-task-body`／`gantt-task-links` を用いて内容・補足・連携先を記述し、必要に応じて追加のタスクブロックを挿入してください。
- `gantt-notes` や `gantt-legend` のフィールドに、矢印や色分けのルール、凡例をまとめると生成AIがビジュアル指示を理解しやすくなります。

### 生成AIに依頼する際の注意
- `data-ai-field` 属性の範囲のみを書き換え、HTML構造・クラス・コメントは保持させてください。
- テキストはビジネス用途を意識した自然な日本語で書き換えるよう指示します。

## 推奨プロンプト
以下を生成AIに渡すことで、テンプレートを意図通りに埋めてもらいやすくなります。

```text
あなたはエグゼクティブ向け資料を作成するアシスタントです。添付のHTMLテンプレートには data-ai-field 属性付きのプレースホルダがあり、必ずその範囲のみを書き換えてください。属性名はコンテンツの意味を示しています。

指示:
1. まず発表のテーマと想定聴衆、伝えたい主要メッセージを整理してください。
2. 各スライドの `p.lead` に、スライド全体の狙いが一読で伝わるリード文を追加します。
3. `chart-card` や `viz-card` では、既に入っている絵文字ベースのサンプルを参考にしながら、絵文字・簡易SVG・表・ASCIIアート等で実際の図表／ポンチ絵を描写してください（例: 絵文字タイムライン・シンプルな表組み・インラインSVGなど）。
4. アイコンや簡易的な図形表現が必要な場合は、Unicode 16.0 / Emoji 16.0 準拠の絵文字で代用可能な箇所を優先的に絵文字で表現してください（例: ✅, 📊, 🚀）。
5. SVGコピー機能に関わる HTML・クラス名・データ属性・JavaScript は削除・改変しないでください。文言のみ必要に応じて編集します。
6. アジェンダや資料の目的に合わせて、必要なスライドを選択・複製・削除し、順序も自由に再構成してください（例: 背景→課題→提案→ロードマップ→まとめ 等）。構成が変わる場合は `footer.next-link` の導入文も実際の並びに合わせて更新します。
7. ロードマップスライドでは `roadmap_col_*` と `roadmap_lane_*` の各フィールドに期間ラベルとアクティビティを整理し、セル内で必要な図形・強調表現（矢印、色、凡例）をテキストで明示してください。
8. ステークホルダー・ガントでは `stakeholder_lane_*` とタスク用フィールドに内容・補足説明・連携先を記述し、各 `gantt-task` の `--start` / `--end` / `--task-color` を調整して時系列と色分けを指定してください。矢印やハイライトの指示は `stakeholder_gantt_*_note` へまとめてください。
9. アジェンダが切り替わる箇所や内容が飛びそうな箇所では、既存のクッションスライドに補足ストーリーとビジュアル指示を記入し、必要なら補足スライド（appendix）を複製して詳細図解を追加します。
10. 文章は自然な日本語で、ビジネス文書らしい簡潔さと具体性を維持してください。
11. すべての出力はHTML全体を返し、既存の構造・クラスや追加説明コメントは変更しないでください。`CONFIDENTIAL` 表示は削除せず維持してください。
```

生成後は内容をプレビューし、テーマの切り替えやスライドの追加／削除を手動で調整してください。

## GAS連携プロンプト（HTML→Googleスライド変換用）
Gemini/ChatGPTに以下のプロンプトを渡すことで、テンプレートHTMLからGoogleスライドを生成するGASコードを出力させることができます。必要に応じてプレゼンテーションの内容を編集したHTMLを添付し、このプロンプトでスクリプト生成を依頼してください。

```text
# 命令
あなたは HTML でデザインされたスライドを Google スライドへ変換することを専門とする熟練の Google Apps Script 開発者です。これから渡す HTML テンプレートは `div.slide-container > section.slide[data-slide-id="..."]` という構造で 1 枚のスライドを表現しており、各スライドの外側には SVG コピー用ボタンなどの補助UIが含まれます。**実際にレイアウトへ反映すべき要素は section.slide 内のみ**であり、補助UIは無視してください。

提供された HTML を分析し、**データとロジックの厳密な分離**という設計原則を守りながら、Google スライド（16:9）を自動生成する GAS を単一のコードブロックで出力してください。作成するスクリプトでは以下を必ず満たします。

- レイアウト・テキスト・配色・太字などを可能な限り忠実に再現し、スライド幅・高さを Slides API から取得して相対位置（%）を pt へ変換して配置する。
- スライドごとのデータ（背景色、テキスト、図形、色など）は `getLayoutData()` の返り値となる JSON 風配列に定義し、ロジック側から参照するだけにする。
- 特定の要素で描画に失敗しても処理全体は止まらず、可能な範囲までスライド生成を続行し、エラー内容をログに残して完走させる。
- 右下の赤文字 `CONFIDENTIAL` や SVG コピー用ボタンなどテンプレート固有の補助 UI はスライド化しない。

# 達成目標
1. **デザインの忠実な再現** – HTML 内のレイアウト・タイポグラフィ・カラーリングを 16:9 スライド上で再現する。必要に応じて SHAPE を合成してグラデーションや背景カードを表現する。
2. **高いメンテナンス性** – テキストや色の変更が `getLayoutData()` のデータ編集だけで完結し、描画ロジックは変更不要である状態を保つ。
3. **エラー耐性** – 個々の要素描画失敗では処理を継続し、全体 fatal error 時のみアラートを出す堅牢なコードを作成する。

# 実行手順
生成する GAS は以下 2 関数のみで構成し、**createSlides() を先頭に配置**してください。

## 1. createSlides() 関数（ロジック層）
最初に以下のコードを **一字一句変更せず** スクリプトの先頭へ記述してください。`getLayoutData()` から相対座標（0–100%）およびメタデータを取得し、Slides API へ描画するエンジンです。

/** ... 省略せずに提示された createSlides() コード全文 ... */

## 2. getLayoutData() 関数（データ層）
次に、HTML の視覚構造を読み解いて作成したレイアウト定義を返す `getLayoutData()` を実装します。

- 各 `section.slide` を 1 枚のスライドとして `backgroundColor`（16進カラー）と `elements` 配列を定義する。
- `elements` 内は **背景（type:'SHAPE'）→テキスト（type:'TEXT'）の順**で並べる。重なり順序を意識し、背景カードはテキストより先に記述する。
- `SHAPE` 要素は `left/top/width/height` を 0–100% で記述し、必要に応じて `shapeColor` を指定する。
- `TEXT` 要素は `text`（改行は \n）、`fontSize`（pt）、`color`、`bold`、`alignment`（SlidesApp.ParagraphAlignment.*）を設定する。フォントは `'Noto Sans JP'` を使用し、必要に応じて調整可。
- HTML のどの要素から変換したのかが分かるように **日本語コメント** を添えてください。
- `.svg-copy` ボタンやクッションコメント等、テンプレートの補助要素はデータに含めない。

# 出力形式
1. `createSlides()`（変更不可）と `getLayoutData()` の 2 関数のみを含む GAS コードを 1 つのコードブロックで出力する。
2. `getLayoutData()` 内のコメントで、各要素が HTML のどの部分に対応するか説明する。
3. 取得したスタイルやコンテンツを固定値としてデータ化し、ロジック層で条件分岐やハードコードを行わない。

以上の指示に厳密に従って GAS コードを生成してください。
```
